{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n// import { changeCount } from '@/api/cart'\nimport CountBox from '@/components/CountBox.vue';\nimport { mapState, mapGetters } from 'vuex';\nexport default {\n  name: 'CartPage',\n  data() {\n    return {\n      isEdit: false\n    };\n  },\n  components: {\n    CountBox\n  },\n  created() {\n    if (this.isLogin) {\n      this.$store.dispatch('cart/getCartAction');\n    }\n  },\n  computed: {\n    ...mapState('cart', ['cartList']),\n    ...mapGetters('cart', ['cartTotal', 'selCount', 'selPrice', 'isAllChecked', 'selCartList']),\n    isLogin() {\n      return this.$store.getters.token;\n    }\n  },\n  methods: {\n    toggleChecked(id) {\n      this.$store.commit('cart/toggleChecked', id);\n    },\n    toggleAllChecked() {\n      this.$store.commit('cart/toggleAllChecked', !this.isAllChecked);\n    },\n    changeCount(goodsNum, goodsId, goodsSkuId) {\n      // console.log(goodsNum, goodsId, goodsSkuId)\n      this.$store.dispatch('cart/changeCountAction', {\n        goodsNum,\n        goodsId,\n        goodsSkuId\n      });\n    },\n    async handleDel() {\n      if (this.selCount === 0) return;\n      await this.$store.dispatch('cart/delAction');\n      this.isEdit = false;\n    },\n    goPay() {\n      if (this.selCount > 0) {\n        this.$router.push({\n          path: '/pay',\n          query: {\n            mode: 'cart',\n            cartId: this.selCartList.map(item => item.id).join(',')\n          }\n        });\n      }\n    }\n  },\n  watch: {\n    isEdit(value) {\n      if (value) {\n        this.$store.commit('cart/toggleAllChecked', false);\n      } else {\n        this.$store.commit('cart/toggleAllChecked', true);\n      }\n    }\n  }\n};","map":{"version":3,"names":["CountBox","mapState","mapGetters","name","data","isEdit","components","created","isLogin","$store","dispatch","computed","getters","token","methods","toggleChecked","id","commit","toggleAllChecked","isAllChecked","changeCount","goodsNum","goodsId","goodsSkuId","handleDel","selCount","goPay","$router","push","path","query","mode","cartId","selCartList","map","item","join","watch","value"],"sources":["src/views/layout/cart.vue"],"sourcesContent":["<template>\r\n  <div class=\"cart\">\r\n    <van-nav-bar title=\"购物车\" fixed />\r\n\r\n    <div v-if=\"isLogin && cartList.length > 0\">\r\n        <!-- 购物车开头 -->\r\n      <div class=\"cart-title\">\r\n        <span class=\"all\">共<i>{{cartTotal}}</i>件商品</span>\r\n        <span @click=\"isEdit=!isEdit\" class=\"edit\" style=\"cursor: pointer;\">\r\n          <van-icon  name=\"edit\" />\r\n          编辑\r\n        </span>\r\n      </div>\r\n\r\n      <!-- 购物车列表 -->\r\n      <div class=\"cart-list\">\r\n        <div class=\"cart-item\" v-for=\"item in cartList\" :key=\"item.goods_id\">\r\n          <van-checkbox @click=\"toggleChecked(item.goods_id)\" :value=\"item.isChecked\"></van-checkbox>\r\n          <div class=\"show\">\r\n            <img :src=\"item.goods.goods_image\" alt=\"\">\r\n          </div>\r\n          <div class=\"info\">\r\n            <span class=\"tit text-ellipsis-2\">{{ item.goods.goods_name }}</span>\r\n            <span class=\"bottom\">\r\n              <div class=\"price\">¥ <span>{{item.goods.goods_price_min}}</span></div>\r\n              <div class=\"count-box\">\r\n                <!-- 既希望保留原本形参，又通调用参数传参 -->\r\n                <CountBox @input=\"value=>changeCount(value,item.goods_id,item.goods_sku_id)\" :value=\"item.goods_num\"></CountBox>\r\n              </div>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"footer-fixed\" @click=\"toggleAllChecked\">\r\n        <div  class=\"all-check\">\r\n          <van-checkbox  icon-size=\"18\" :value=\"isAllChecked\"></van-checkbox>\r\n          全选\r\n        </div>\r\n        <div class=\"all-total\">\r\n          <div class=\"price\">\r\n            <span>合计：</span>\r\n            <span>¥ <i class=\"totalPrice\">{{selPrice}}</i></span>\r\n          </div>\r\n          <div @click=\"goPay\" v-if=\"!isEdit\" class=\"goPay\" :class=\"{disabled:selCount===0}\">结算({{selCount}})</div>\r\n          <div v-else @click=\"handleDel\" class=\"delete\" :class=\"{disabled:selCount===0}\">删除</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"empty-cart\" v-else>\r\n      <img src=\"@/assets/empty.png\" alt=\"\">\r\n      <div class=\"tips\">\r\n        您的购物车是空的, 快去逛逛吧\r\n      </div>\r\n      <div class=\"btn\" @click=\"$router.push('/')\">去逛逛</div>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// import { changeCount } from '@/api/cart'\r\nimport CountBox from '@/components/CountBox.vue'\r\nimport { mapState, mapGetters } from 'vuex'\r\nexport default {\r\n  name: 'CartPage',\r\n  data () {\r\n    return {\r\n      isEdit: false\r\n    }\r\n  },\r\n  components: {\r\n    CountBox\r\n  },\r\n  created () {\r\n    if (this.isLogin) {\r\n      this.$store.dispatch('cart/getCartAction')\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState('cart', ['cartList']),\r\n    ...mapGetters('cart', ['cartTotal', 'selCount', 'selPrice', 'isAllChecked', 'selCartList']),\r\n    isLogin () {\r\n      return this.$store.getters.token\r\n    }\r\n  },\r\n  methods: {\r\n    toggleChecked (id) {\r\n      this.$store.commit('cart/toggleChecked', id)\r\n    },\r\n    toggleAllChecked () {\r\n      this.$store.commit('cart/toggleAllChecked', !this.isAllChecked)\r\n    },\r\n    changeCount (goodsNum, goodsId, goodsSkuId) {\r\n      // console.log(goodsNum, goodsId, goodsSkuId)\r\n      this.$store.dispatch('cart/changeCountAction', {\r\n        goodsNum,\r\n        goodsId,\r\n        goodsSkuId\r\n      })\r\n    },\r\n    async handleDel () {\r\n      if (this.selCount === 0) return\r\n      await this.$store.dispatch('cart/delAction')\r\n      this.isEdit = false\r\n    },\r\n    goPay () {\r\n      if (this.selCount > 0) {\r\n        this.$router.push({\r\n          path: '/pay',\r\n          query: {\r\n            mode: 'cart',\r\n            cartId: this.selCartList.map(item => item.id).join(',')\r\n          }\r\n        })\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    isEdit (value) {\r\n      if (value) {\r\n        this.$store.commit('cart/toggleAllChecked', false)\r\n      } else {\r\n        this.$store.commit('cart/toggleAllChecked', true)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.cart {\r\n  padding-top: 46px;\r\n  padding-bottom: 100px;\r\n  background-color: #f5f5f5;\r\n  min-height: 100vh;\r\n  .cart-title {\r\n    height: 40px;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    padding: 0 10px;\r\n    font-size: 14px;\r\n    .all {\r\n      i {\r\n        font-style: normal;\r\n        margin: 0 2px;\r\n        color: #fa2209;\r\n        font-size: 16px;\r\n      }\r\n    }\r\n    .edit {\r\n      .van-icon {\r\n        font-size: 18px;\r\n      }\r\n    }\r\n  }\r\n\r\n  .cart-item {\r\n    margin: 0 10px 10px 10px;\r\n    padding: 10px;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    background-color: #ffffff;\r\n    border-radius: 5px;\r\n\r\n    .show img {\r\n      width: 100px;\r\n      height: 100px;\r\n    }\r\n    .info {\r\n      width: 210px;\r\n      padding: 10px 5px;\r\n      font-size: 14px;\r\n      display: flex;\r\n      flex-direction: column;\r\n      justify-content: space-between;\r\n\r\n      .bottom {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        .price {\r\n          display: flex;\r\n          align-items: flex-end;\r\n          color: #fa2209;\r\n          font-size: 12px;\r\n          span {\r\n            font-size: 16px;\r\n          }\r\n        }\r\n        .count-box {\r\n          display: flex;\r\n          width: 110px;\r\n          .add,\r\n          .minus {\r\n            width: 30px;\r\n            height: 30px;\r\n            outline: none;\r\n            border: none;\r\n          }\r\n          .inp {\r\n            width: 40px;\r\n            height: 30px;\r\n            outline: none;\r\n            border: none;\r\n            background-color: #efefef;\r\n            text-align: center;\r\n            margin: 0 5px;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.footer-fixed {\r\n  position: fixed;\r\n  left: 0;\r\n  bottom: 50px;\r\n  height: 50px;\r\n  width: 100%;\r\n  border-bottom: 1px solid #ccc;\r\n  background-color: #fff;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 0 10px;\r\n\r\n  .all-check {\r\n    display: flex;\r\n    align-items: center;\r\n    .van-checkbox {\r\n      margin-right: 5px;\r\n    }\r\n  }\r\n\r\n  .all-total {\r\n    display: flex;\r\n    line-height: 36px;\r\n    .price {\r\n      font-size: 14px;\r\n      margin-right: 10px;\r\n      .totalPrice {\r\n        color: #fa2209;\r\n        font-size: 18px;\r\n        font-style: normal;\r\n      }\r\n    }\r\n\r\n    .goPay, .delete {\r\n      min-width: 100px;\r\n      height: 36px;\r\n      line-height: 36px;\r\n      text-align: center;\r\n      background-color: #fa2f21;\r\n      color: #fff;\r\n      border-radius: 18px;\r\n      &.disabled {\r\n        background-color: #ff9779;\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n.empty-cart {\r\n  padding: 80px 30px;\r\n  img {\r\n    width: 140px;\r\n    height: 92px;\r\n    display: block;\r\n    margin: 0 auto;\r\n  }\r\n  .tips {\r\n    text-align: center;\r\n    color: #666;\r\n    margin: 30px;\r\n  }\r\n  .btn {\r\n    width: 110px;\r\n    height: 32px;\r\n    line-height: 32px;\r\n    text-align: center;\r\n    background-color: #fa2c20;\r\n    border-radius: 16px;\r\n    color: #fff;\r\n    display: block;\r\n    margin: 0 auto;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":";AA6DA;AACA,OAAAA,QAAA;AACA,SAAAC,QAAA,EAAAC,UAAA;AACA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,MAAA;IACA;EACA;EACAC,UAAA;IACAN;EACA;EACAO,QAAA;IACA,SAAAC,OAAA;MACA,KAAAC,MAAA,CAAAC,QAAA;IACA;EACA;EACAC,QAAA;IACA,GAAAV,QAAA;IACA,GAAAC,UAAA;IACAM,QAAA;MACA,YAAAC,MAAA,CAAAG,OAAA,CAAAC,KAAA;IACA;EACA;EACAC,OAAA;IACAC,cAAAC,EAAA;MACA,KAAAP,MAAA,CAAAQ,MAAA,uBAAAD,EAAA;IACA;IACAE,iBAAA;MACA,KAAAT,MAAA,CAAAQ,MAAA,gCAAAE,YAAA;IACA;IACAC,YAAAC,QAAA,EAAAC,OAAA,EAAAC,UAAA;MACA;MACA,KAAAd,MAAA,CAAAC,QAAA;QACAW,QAAA;QACAC,OAAA;QACAC;MACA;IACA;IACA,MAAAC,UAAA;MACA,SAAAC,QAAA;MACA,WAAAhB,MAAA,CAAAC,QAAA;MACA,KAAAL,MAAA;IACA;IACAqB,MAAA;MACA,SAAAD,QAAA;QACA,KAAAE,OAAA,CAAAC,IAAA;UACAC,IAAA;UACAC,KAAA;YACAC,IAAA;YACAC,MAAA,OAAAC,WAAA,CAAAC,GAAA,CAAAC,IAAA,IAAAA,IAAA,CAAAnB,EAAA,EAAAoB,IAAA;UACA;QACA;MACA;IACA;EACA;EACAC,KAAA;IACAhC,OAAAiC,KAAA;MACA,IAAAA,KAAA;QACA,KAAA7B,MAAA,CAAAQ,MAAA;MACA;QACA,KAAAR,MAAA,CAAAQ,MAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}